window.DL=window.DL||{};(function(Modernizr,$,DL){"use strict";function initSelect2(){var $select=$("select");var theme=$select.attr("data-selecttheme");if(!theme){theme="qibla"}var dropDwParent=document.getElementById("dlform_filter");if(!dropDwParent){dropDwParent=document.body}$select.select2({theme:theme,width:"100%",dropdownParent:$(dropDwParent),templateResult:templateResult});$select.change(function(e){DL.Utils.Events.dispatchEvent("select2change",e.target)})}function overlay(){var $select=$("select");var list=document.querySelector(".dllistings-list");var toolbar=document.querySelector(".dllistings-toolbar");var map=document.querySelector(".dlgoogle-map");if(!list){return}var sel=false;$select.on("select2:open",function(){sel=$(this).attr("id");if(toolbar){toolbar.style.transition="opacity 275ms ease-in-out";toolbar.style.opacity=".3"}if(map){map.style.transition="opacity 275ms ease-in-out";map.style.opacity=".3"}if(list){list.classList.add("overlay");list.style.transition="opacity 275ms ease-in-out";list.style.opacity=".3"}});$select.on("select2:close",function(){if($(this).attr("id")===sel){if(toolbar){toolbar.style.opacity="1"}if(map){map.style.opacity="1"}if(list){list.classList.remove("overlay");list.style.opacity="1"}}})}function templateResult(state){if(!state.id){return state.text}var textState=state.text,markup=state.element.getAttribute("data-markup");if(null!==markup){textState=whitHeading(markup,state)}return textState}function whitHeading(markup,state){return $('<strong class="select2-results__option-heading">'+markup+"</strong>"+'<span class="select2-results__option-text">'+state.text+"</span>")}window.addEventListener("load",function(){initSelect2();overlay()});$(document.body).bind("country_to_state_changed",function(){setTimeout(function(){initSelect2()},0)})})(window.Modernizr,window.jQuery,window.DL);