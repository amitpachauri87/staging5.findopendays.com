window.DL=window.DL||{};(function(_,$,DL,localized){"use strict";DL.LoginRegisterForm={requestModal:function(evt){evt.preventDefault();evt.stopImmediatePropagation();DL.Modal.construct("script",{url:localized.site_url+"/index.php",data:{dlajax_action:"modal_login_register_request"},beforeSend:null,complete:null},evt)},buildForm:function(){if(!DL.Modal.LoginRegisterForm.isInUse){DL.Modal.LoginRegisterForm.init()}},addListeners:function(){var addListener=DL.Utils.Events.addListener.bind(this);addListener(this.modalElement,"click",this.requestModal);addListener(this.modalElement,"preload-modal",this.requestModal,{once:true});addListener(window,"dl_modal_opened",this.buildForm);addListener(window,"dl_modal_closed",function(){window.removeEventListener("dl_modal_opened",this.buildForm)}.bind(this))},modalLoginAction:function(){if(window.location.search&&document.referrer.indexOf("action=resetpass")){if(!window.location.search.search("=")){return}var action=window.location.search.substring(1).split("=");if("action"===action[0]&&"modal-login"===action[1]){DL.Modal.construct("html");DL.Modal.LoginRegisterForm.init();DL.Modal.autoOpen()}DL.Utils.Events.addListener(document.querySelector(".dlmodal-close, .dlmodal-overlay"),"click",function(evt){var modal=document.getElementById("dlmodal");if(evt.target.classList.contains("dlmodal-close")||evt.target.classList.contains("dlmodal-overlay")||evt.target.classList.contains("la-times")){modal.remove()}})}},init:function(){if(!localized.loggedin){this.addListeners()}},construct:function(element){_.bindAll(this,"requestModal","addListeners");this.modalElement=element;if(!this.modalElement){return false}this.form=null;return this}};DL.LoginRegisterFormFactory=function(element){return Object.create(DL.LoginRegisterForm).construct(element)};window.addEventListener("load",function(){setTimeout(function(){DL.LoginRegisterForm.modalLoginAction();var loginRegisterForm=DL.LoginRegisterFormFactory(document.querySelector(".is-login-register-toggler"));if(loginRegisterForm){loginRegisterForm.init();DL.Utils.Events.dispatchEvent("preload-modal",loginRegisterForm.modalElement)}},0)})})(_,window.jQuery,window.DL,window.dllocalized);